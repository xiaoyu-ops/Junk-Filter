# Phase 3 & å‰åç«¯é›†æˆ - æ‰§è¡Œæ‘˜è¦

**æ—¥æœŸ**: 2026-02-26
**ç‰ˆæœ¬**: æœ€ç»ˆè¯„ä¼°å’Œè¡ŒåŠ¨è®¡åˆ’
**å…³é”®å†³ç­–**: âœ… å‰ç«¯å·²å°±ç»ªï¼Œå¯ä»¥å¼€å§‹åç«¯é›†æˆ

---

## ğŸ¯ æ ¸å¿ƒé—®é¢˜å›ç­”

### Q1: å‰ç«¯æ˜¯å¦å·²åŸºæœ¬å®Œæˆï¼Ÿ

**ç­”æ¡ˆ**: âœ… **æ˜¯çš„ï¼Œå‰ç«¯å·²å®Œæˆ 90%**

#### å®Œæˆçš„å†…å®¹
| é¡¹ç›® | å®Œæˆåº¦ | è¯´æ˜ |
|------|--------|------|
| UI ç»„ä»¶ | 100% | æ‰€æœ‰ 6 ä¸ªæ ¸å¿ƒç»„ä»¶å®Œæˆ |
| äº¤äº’é€»è¾‘ | 95% | æ‰€æœ‰ç”¨æˆ·äº¤äº’å®Œæˆ |
| æ ·å¼å’ŒåŠ¨ç”» | 100% | åŒ…æ‹¬æš—é»‘æ¨¡å¼ |
| SSE æµå¼ | 100% | å®Œæ•´çš„æµå¼å›å¤æ”¯æŒ |
| é”™è¯¯å¤„ç† | 85% | ä¸»è¦åœºæ™¯å¤„ç†å®Œå–„ |
| æµ‹è¯•æ¡†æ¶ | 60% | å¯ä»¥æ·»åŠ å•å…ƒ/E2E æµ‹è¯• |
| æ–‡æ¡£ | 95% | é›†æˆæŒ‡å—å®Œæ•´ |

#### ç¼ºå°‘çš„å†…å®¹
- â³ æ¶ˆæ¯æ•°æ®åº“æŒä¹…åŒ– (éœ€åç«¯)
- â³ ç”¨æˆ·è®¤è¯ç³»ç»Ÿ (éœ€åç«¯)
- â³ å•å…ƒå’Œ E2E æµ‹è¯• (å¯åç»­æ·»åŠ )

### Q2: æ˜¯å¦å¯ä»¥å¼€å§‹å‰åç«¯é›†æˆï¼Ÿ

**ç­”æ¡ˆ**: âœ… **å®Œå…¨å¯ä»¥ï¼**

**ç†ç”±**:
1. å‰ç«¯ä»£ç å·²ç¨³å®šï¼ŒåŸºæœ¬ä¸ä¼šå†æ”¹åŠ¨æ ¸å¿ƒåŠŸèƒ½
2. API æ¥å£å·²æ˜ç¡®å®šä¹‰ï¼Œåç«¯å¯ç‹¬ç«‹å®ç°
3. å‰åç«¯å¯ä»¥**å¹¶è¡Œå¼€å‘**
4. é›†æˆç‚¹æ¸…æ™°ï¼Œå¯¹æ¥å®¹æ˜“

### Q3: Phase 3 å…·ä½“è¦åšä»€ä¹ˆï¼Ÿ

**ç­”æ¡ˆ**: Phase 3 = æ•°æ®æŒä¹…åŒ– + API é›†æˆ + æµ‹è¯•

```
å‰ç«¯            åç«¯                è”è°ƒ
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ useAPI      API å®ç°       å¯¹æ¥æµ‹è¯•
  â”‚ é›†æˆ API    è®¤è¯ç³»ç»Ÿ       åŠŸèƒ½æµ‹è¯•
  â”‚ æµ‹è¯•æ¡†æ¶    æ•°æ®åº“         æ€§èƒ½æµ‹è¯•
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       ~1-2å‘¨      ~2-3å‘¨        ~1å‘¨
```

---

## ğŸ“Š å‰ç«¯å®Œæˆåº¦è¯¦ç»†åˆ†æ

### ä»£ç ç»Ÿè®¡

| ç±»åˆ« | æ–‡ä»¶æ•° | è¡Œæ•° | å®Œæˆåº¦ |
|------|--------|------|--------|
| ç»„ä»¶ | 6 | ~1200 | 100% |
| Composables | 5 | ~800 | 90% |
| Stores | 2 | ~300 | 80% |
| æ ·å¼ | 1 | ~500 | 100% |
| é…ç½® | 2 | ~100 | 90% |
| æ–‡æ¡£ | 7 | ~3000 | 95% |
| **æ€»è®¡** | **23** | **~5900** | **90%** |

### åŠŸèƒ½æ¸…å•

#### âœ… å®Œå…¨å®Œæˆ (100%)
- [ ] ä»»åŠ¡åˆ›å»ºæ¨¡æ€æ¡† (UI + éªŒè¯)
- [ ] ä»»åŠ¡åˆ—è¡¨é€‰ä¸­çŠ¶æ€
- [ ] æ¶ˆæ¯å‘é€/æ¥æ”¶ UI
- [ ] Markdown æ¸²æŸ“ + XSS é˜²æŠ¤
- [ ] ExecutionCard å››ç§çŠ¶æ€ + åŠ¨ç”»
- [ ] SSE æµå¼è¿æ¥å’Œå¤„ç†
- [ ] æ™ºèƒ½æ»šåŠ¨é”å®š
- [ ] æš—é»‘æ¨¡å¼å®Œæ•´æ”¯æŒ
- [ ] æ—¶é—´æˆ³æ ¼å¼åŒ–
- [ ] é”™è¯¯æç¤ºå’Œåé¦ˆ

#### âš ï¸ éƒ¨åˆ†å®Œæˆ (90-99%)
- [ ] ä»»åŠ¡ç¼–è¾‘ (UI å®Œæˆï¼ŒAPI å¾…é›†æˆ)
- [ ] ä»»åŠ¡åˆ é™¤ (UI å®Œæˆï¼ŒAPI å¾…é›†æˆ)
- [ ] æ¶ˆæ¯æœç´¢ (UI å¾…æ·»åŠ ï¼ŒAPI å¾…å®ç°)
- [ ] æ•°æ®ç¼“å­˜ (æ¡†æ¶å‡†å¤‡å¥½ï¼Œç­–ç•¥å¾…å®š)

#### â³ éœ€è¦åç«¯æ”¯æŒ
- [ ] æ¶ˆæ¯æŒä¹…åŒ–
- [ ] ä»»åŠ¡æŒä¹…åŒ–
- [ ] ç”¨æˆ·è®¤è¯
- [ ] å¤šç”¨æˆ·éš”ç¦»

---

## ğŸ”Œ å‰åç«¯é›†æˆå‡†å¤‡åº¦

### å‰ç«¯å‡†å¤‡å¥½äº†å—ï¼Ÿ

âœ… **Yes, 100% å‡†å¤‡å¥½**

- [x] æ‰€æœ‰ UI å®Œæˆ
- [x] æ‰€æœ‰äº¤äº’é€»è¾‘å®Œæˆ
- [x] API æ¥å£è®¾è®¡å®Œæˆ
- [x] é”™è¯¯å¤„ç†æ¡†æ¶å®Œæˆ
- [x] ç¯å¢ƒé…ç½®å‡†å¤‡å¥½
- [x] æ–‡æ¡£å®Œæ•´

### åç«¯å‡†å¤‡å¥½äº†å—ï¼Ÿ

âŒ **No, éœ€è¦ç«‹å³å¯åŠ¨**

éœ€è¦åšçš„å·¥ä½œ:
- [ ] æ•°æ®åº“è®¾è®¡
- [ ] API å®ç°
- [ ] è®¤è¯ç³»ç»Ÿ
- [ ] SSE ç«¯ç‚¹
- [ ] é”™è¯¯å¤„ç†

---

## ğŸ“‹ ç«‹å³å¯åŠ¨çš„è¡ŒåŠ¨è®¡åˆ’

### ğŸ¯ å‰ç«¯è¡ŒåŠ¨ (è¿™å‘¨)

#### ä»»åŠ¡ 1: åˆ›å»º useAPI Composable (1-2 å¤©)
```javascript
// src/composables/useAPI.js
export const useAPI = () => {
  const request = async (path, options = {}) => {
    // HTTP è¯·æ±‚çš„ç»Ÿä¸€æ¥å£
  }

  return {
    tasks: { list, create, update, delete },
    messages: { list, save },
    auth: { login, register },
  }
}
```

#### ä»»åŠ¡ 2: ä¿®æ”¹ useTaskStore é›†æˆ API (2 å¤©)
- è°ƒç”¨ `api.tasks.list()` åŠ è½½ä»»åŠ¡
- è°ƒç”¨ `api.tasks.create()` åˆ›å»ºä»»åŠ¡
- è°ƒç”¨ `api.tasks.delete()` åˆ é™¤ä»»åŠ¡

#### ä»»åŠ¡ 3: ä¿®æ”¹ TaskChat é›†æˆ API (2 å¤©)
- è°ƒç”¨ `api.messages.list()` åŠ è½½æ¶ˆæ¯å†å²
- è°ƒç”¨ `api.messages.save()` ä¿å­˜æ¶ˆæ¯
- é›†æˆ SSE æµå¼å›å¤

#### ä»»åŠ¡ 4: å‡†å¤‡æµ‹è¯•æ¡†æ¶ (1 å¤©)
- Vitest å•å…ƒæµ‹è¯•é…ç½®
- Playwright E2E æµ‹è¯•é…ç½®

**å°è®¡**: 6 å¤©å·¦å³

### ğŸ¯ åç«¯è¡ŒåŠ¨ (ç«‹å³å¯åŠ¨)

#### ä»»åŠ¡ 1: æ•°æ®åº“è®¾è®¡ (2 å¤©)
```sql
CREATE TABLE tasks (...)
CREATE TABLE messages (...)
CREATE TABLE executions (...)
```

#### ä»»åŠ¡ 2: åŸºç¡€ API å®ç° (5 å¤©)
- `/api/tasks` CRUD
- `/api/messages` CRUD
- `/api/tasks/:id/messages` æŸ¥è¯¢

#### ä»»åŠ¡ 3: SSE ç«¯ç‚¹å®ç° (3 å¤©)
- `/api/chat/stream` æµå¼å›å¤
- äº‹ä»¶æ ¼å¼: delta/execution/done/error

#### ä»»åŠ¡ 4: è®¤è¯ç³»ç»Ÿ (3 å¤©)
- JWT æˆ– Session
- `/api/auth/login`
- `/api/auth/register`

#### ä»»åŠ¡ 5: é”™è¯¯å¤„ç†å’Œæ—¥å¿— (2 å¤©)

**å°è®¡**: 15 å¤©å·¦å³

### ğŸ”„ å¹¶è¡Œæ—¶é—´è¡¨

```
å‘¨ 1:
â”œâ”€ å‰ç«¯: åˆ›å»º useAPI Composable
â”œâ”€ åç«¯: æ•°æ®åº“è®¾è®¡ + åŸºç¡€ API
â””â”€ è”è°ƒ: API ç«¯ç‚¹å¯¹æ¥æµ‹è¯•

å‘¨ 2:
â”œâ”€ å‰ç«¯: é›†æˆ useAPI åˆ°å„ç»„ä»¶
â”œâ”€ åç«¯: å®Œæˆ SSE å’Œè®¤è¯
â””â”€ è”è°ƒ: æ¶ˆæ¯æŒä¹…åŒ–æµ‹è¯•

å‘¨ 3:
â”œâ”€ å‰ç«¯: æ·»åŠ æµ‹è¯•æ¡†æ¶
â”œâ”€ åç«¯: æ€§èƒ½ä¼˜åŒ–å’Œç¨³å®šæ€§
â””â”€ è”è°ƒ: å®Œæ•´åŠŸèƒ½æµ‹è¯•

å‘¨ 4:
â”œâ”€ å‰ç«¯: å•å…ƒæµ‹è¯• + E2E æµ‹è¯•
â”œâ”€ åç«¯: ç›‘æ§å’Œæ—¥å¿—å®Œå–„
â””â”€ è”è°ƒ: ç”Ÿäº§ç¯å¢ƒå‡†å¤‡
```

---

## ğŸ“ API è§„èŒƒ (å‰åç«¯è¾¾æˆä¸€è‡´)

### åŸºç¡€é…ç½®

| é¡¹ | å€¼ | è¯´æ˜ |
|----|-----|------|
| Base URL | `http://localhost:3000` (dev) | |
| å“åº”æ ¼å¼ | JSON | |
| è®¤è¯ | JWT in header | `Authorization: Bearer <token>` |
| CORS | æ”¯æŒ | è·¨åŸŸè¯·æ±‚ |
| è¶…æ—¶ | 30s | é»˜è®¤è¶…æ—¶ |

### ä»»åŠ¡ API

```
GET    /api/tasks              è·å–ä»»åŠ¡åˆ—è¡¨
POST   /api/tasks              åˆ›å»ºä»»åŠ¡
GET    /api/tasks/:id          è·å–ä»»åŠ¡è¯¦æƒ…
PUT    /api/tasks/:id          æ›´æ–°ä»»åŠ¡
DELETE /api/tasks/:id          åˆ é™¤ä»»åŠ¡
POST   /api/tasks/:id/execute  æ‰‹åŠ¨æ‰§è¡Œä»»åŠ¡
```

### æ¶ˆæ¯ API

```
GET    /api/tasks/:id/messages    è·å–æ¶ˆæ¯å†å²
POST   /api/messages              ä¿å­˜æ¶ˆæ¯
```

### è®¤è¯ API

```
POST   /api/auth/login            ç”¨æˆ·ç™»å½•
POST   /api/auth/register         ç”¨æˆ·æ³¨å†Œ
```

### SSE æµå¼ API

```
GET    /api/chat/stream?taskId=xxx&message=hello
```

---

## ğŸ” æŠ€æœ¯æ ˆå»ºè®®

### å‰ç«¯ (å·²ç¡®å®š)
- Vue 3 Composition API
- Vite
- Tailwind CSS
- Pinia
- Vitest
- Playwright

### åç«¯ (å»ºè®®)

**Option A: Node.js/Express** (æ¨èå¿«é€Ÿå¼€å‘)
```
Express + TypeScript + PostgreSQL + JWT
```

**Option B: Python/FastAPI** (æ¨èçµæ´»æ€§)
```
FastAPI + SQLAlchemy + PostgreSQL + JWT
```

**Option C: Go/Gin** (æ¨èæ€§èƒ½)
```
Gin + GORM + PostgreSQL + JWT
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### å‰ç«¯éœ€è¦ç¡®ä¿
- [ ] useAPI Composable åšå¥½ token ç®¡ç†
- [ ] é”™è¯¯å¤„ç†å®Œå–„ï¼ˆ401/403/500 ç­‰ï¼‰
- [ ] è¯·æ±‚è¶…æ—¶å¤„ç†
- [ ] è‡ªåŠ¨é‡è¯•æœºåˆ¶
- [ ] ç¦»çº¿é™çº§æ–¹æ¡ˆ

### åç«¯éœ€è¦ç¡®ä¿
- [ ] CORS æ­£ç¡®é…ç½®
- [ ] SSE äº‹ä»¶æ ¼å¼ä¸€è‡´
- [ ] é”™è¯¯è¿”å›æ ¼å¼ä¸€è‡´
- [ ] è¯·æ±‚é€Ÿç‡é™åˆ¶
- [ ] æ—¥å¿—å®Œæ•´

### è”è°ƒéœ€è¦ç¡®ä¿
- [ ] API æ–‡æ¡£åŒæ­¥
- [ ] é”™è¯¯ç å®šä¹‰ä¸€è‡´
- [ ] æ•°æ®æ ¼å¼å¯¹é½
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•

---

## ğŸ¯ é‡Œç¨‹ç¢‘ (é¢„è®¡ 4 å‘¨å®Œæˆ)

### ç¬¬ 1 å‘¨æœ« (ç¬¬ 5 å¤©)
âœ… åç«¯åŸºç¡€ API å¯ç”¨
âœ… å‰ç«¯ useAPI å®Œæˆ

### ç¬¬ 2 å‘¨æœ« (ç¬¬ 12 å¤©)
âœ… ä»»åŠ¡ CRUD å®Œæ•´è”è°ƒ
âœ… æ¶ˆæ¯ä¿å­˜åŠŸèƒ½å¯ç”¨
âœ… SSE æµå¼å›å¤å¯ç”¨

### ç¬¬ 3 å‘¨æœ« (ç¬¬ 19 å¤©)
âœ… ç”¨æˆ·è®¤è¯å®Œæˆ
âœ… æ‰€æœ‰åŠŸèƒ½é›†æˆå®Œæˆ
âœ… åŸºæœ¬åŠŸèƒ½æµ‹è¯•é€šè¿‡

### ç¬¬ 4 å‘¨æœ« (ç¬¬ 26 å¤©)
âœ… æ€§èƒ½ä¼˜åŒ–å®Œæˆ
âœ… æµ‹è¯•è¦†ç›–ç‡ > 80%
âœ… ç”Ÿäº§ç¯å¢ƒå‡†å¤‡å¥½

---

## ğŸ“Š æˆæœ¬ä¼°è®¡

### å¼€å‘å·¥æ—¶

| è§’è‰² | å·¥ä½œ | é¢„ä¼° (äººå¤©) | è¯´æ˜ |
|------|------|-----------|------|
| å‰ç«¯ | API é›†æˆ | 5-6 | useAPI + å„ç»„ä»¶é›†æˆ |
| å‰ç«¯ | æµ‹è¯•æ¡†æ¶ | 3-4 | å•å…ƒæµ‹è¯• + E2E |
| åç«¯ | æ•°æ®åº“ + API | 8-10 | å®Œæ•´ CRUD å®ç° |
| åç«¯ | è®¤è¯ç³»ç»Ÿ | 3-4 | JWT å®ç° |
| åç«¯ | SSE ç«¯ç‚¹ | 2-3 | æµå¼å›å¤å®ç° |
| å…¨æ ˆ | è”è°ƒå’Œä¼˜åŒ– | 5-7 | é›†æˆæµ‹è¯• + æ€§èƒ½ä¼˜åŒ– |
| **æ€»è®¡** | **-** | **26-34** | **çº¦ 4-5 å‘¨** |

### èµ„æºéœ€æ±‚

- 1 åå‰ç«¯å¼€å‘ (å…¨èŒ)
- 1-2 ååç«¯å¼€å‘ (å…¨èŒ)
- å¯é€‰: 1 å QA (å…¼èŒ)

---

## âœ… æœ€ç»ˆå»ºè®®

### ç«‹å³è¡ŒåŠ¨

1. **æœ¬å‘¨**:
   - [x] ç¡®è®¤åç«¯æŠ€æœ¯æ ˆ
   - [x] ç¡®è®¤æ•°æ®åº“è®¾è®¡
   - [x] å‰ç«¯åˆ›å»º useAPI Composable

2. **ä¸‹å‘¨**:
   - [ ] åç«¯å¯åŠ¨ API å¼€å‘
   - [ ] å‰ç«¯å®Œæˆ API é›†æˆ
   - [ ] ç¬¬ä¸€ä¸ª API ç«¯ç‚¹è”è°ƒæˆåŠŸ

3. **æ¥ä¸‹æ¥çš„ 2 å‘¨**:
   - [ ] æ‰€æœ‰åŠŸèƒ½é›†æˆå®Œæˆ
   - [ ] åŸºæœ¬åŠŸèƒ½æµ‹è¯•é€šè¿‡
   - [ ] æ€§èƒ½ä¼˜åŒ–å®Œæˆ

### æˆåŠŸæ ‡å¿—

âœ… **ç”Ÿäº§å°±ç»ªæ ‡å‡†**:
- æ‰€æœ‰ CRUD æ“ä½œæ­£å¸¸
- æ¶ˆæ¯æŒä¹…åŒ–å®Œæ•´
- ç”¨æˆ·è®¤è¯å·¥ä½œ
- SSE æµå¼ç¨³å®š
- æµ‹è¯•è¦†ç›–ç‡ > 80%
- æ€§èƒ½è¾¾æ ‡ (P95 < 500ms)
- æ–‡æ¡£å®Œæ•´

---

## ğŸŠ æ€»ç»“

### ç°çŠ¶
âœ… **å‰ç«¯ 90% å®Œæˆï¼Œå·²å°±ç»ª**
- æ‰€æœ‰ UI ç»„ä»¶å®Œæˆ
- æ‰€æœ‰äº¤äº’é€»è¾‘å®Œæˆ
- ä»£ç æ–‡æ¡£å®Œæ•´
- å¯ä»¥ç«‹å³å¼€å§‹åç«¯é›†æˆ

### å»ºè®®
âœ… **ç°åœ¨å°±å¼€å§‹åç«¯å¼€å‘**
- å‰åç«¯å¯ä»¥å¹¶è¡Œ
- 2-3 å‘¨å†…å¯ä»¥é›†æˆ
- 4 å‘¨å†…å¯ä»¥ç”Ÿäº§å°±ç»ª

### ä¸‹ä¸€æ­¥
1. ç¡®è®¤åç«¯æŠ€æœ¯æ ˆ
2. å¯åŠ¨åç«¯å¼€å‘
3. å‰ç«¯åˆ›å»º useAPI
4. ä¸¤å‘¨åå¼€å§‹è”è°ƒ

---

**ğŸš€ å‰ç«¯å·²å‡†å¤‡å¥½ï¼ç°åœ¨è½®åˆ°åç«¯åŠ é€Ÿäº†ï¼**

**é¢„è®¡ 4 å‘¨è¾¾åˆ°ç”Ÿäº§å°±ç»ªçŠ¶æ€ã€‚**

å‡†å¤‡å¥½å¼€å§‹ Phase 3 äº†å—ï¼Ÿ
